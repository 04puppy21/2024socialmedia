# 缺失值处理
## 一.名词定义
缺失值处理是数据分析中的一种技术，用于识别、处理和填补数据集中缺失的数据。这些缺失可能由于数据收集过程中的错误、丢失或不完整等原因造成。
### 1.完全变量与不完全变量
在数据集中，我们常将不含缺失值的变量称为完全变量，数据集中含有缺失值的变量称为不完全变量。
如下图，‘born’列就属于不完全变量，另外两列属于完全变量。
![image](https://github.com/user-attachments/assets/c607d874-d7c5-444f-b79f-3eb61faca59a)
### 2.缺失数据的类型
![image](https://github.com/user-attachments/assets/cf10abd4-63cf-489a-8a0c-cf5ea3612b86)
#### （1）随机丢失
如果数据的缺失与数据集中的其他观测值有关，但缺失本身是随机的，那么这种缺失被称为随机丢失。例如，一个健康调查中，体重较重的人可能更不愿意报告他们的体重，但这种不愿意与他们的其他健康指标无关。
#### （2）完全随机丢失
如果数据的缺失是完全随机的，与数据本身或其他数据无关，那么这种缺失被称为完全随机缺失。例如，一个调查问卷中有10个问题，每个问题被回答的概率完全相同，不受其他问题回答情况的影响。
#### （3）非随机丢失
如果数据的缺失与数据本身有关，且这种关系不是随机的，那么这种缺失被称为非随机缺失。例如，一个关于收入的调查，高收入者可能故意不报告他们的收入，这种缺失与收入水平直接相关

正确判断缺失值的类型，能给我们的工作带来很大的便利，但目前还没有一套规范的缺失值类型判断标准。大多是依据经验或业务进行判断。
## 二、背景分析
在数据科学、统计分析与机器学习等领域，数据集经常包含缺失值。这些缺失值如果不进行适当处理，可能会影响分析结果的准确性与模型的性能。因此，缺失值处理是数据预处理的关键步骤之一。正如那句经典的：“数据分析中的大部分时间都花在了数据预处理上。”数据预处理做得好，往往让我们的数据分析工作事半功倍。其中，如何正确处理缺失值，更是重中之重。
### 1.统计分析的挑战
在统计分析中，缺失值可能会导致分析结果的偏差。例如，如果缺失值不是随机的，那么基于不完整数据的统计推断可能会产生误导。
### 2.机器学习模型的要求
大多数机器学习算法都要求输入数据是完整的，因为它们依赖于数据中的模式来构建模型。缺失值可能会干扰这些模式的识别。
### 3.法规和伦理的要求
在某些领域，如医疗保健和金融，法规可能要求对数据进行严格的处理，包括缺失值的处理，以确保数据的隐私和安全性。
### 4.业务决策的影响
在商业环境中，数据驱动的决策依赖于准确和完整的数据。缺失值可能会影响业务分析的结果，从而影响决策的质量。

缺失值处理在多个学科领域都有应用，包括社会科学、生物统计学、工程学等，这些领域中的研究和实践都依赖于高质量的数据。
# 三.举例
假设有一个数据集，记录了五位同学的数学、英语成绩，其中均有缺失值。
```python
import pandas as pd
import numpy as np
from sklearn.impute import KNNImputer
from sklearn.linear_model import LinearRegression

# 创建示例数据集
data = {
    '学生': ['A', 'B', 'C', 'D', 'E'],
    '数学成绩': [90, np.nan, 85, np.nan, 95],
    '英语成绩': [np.nan, 75, 80, 70, 90]
}
df = pd.DataFrame(data)
```
## 1. 使用平均值填补：
如果数据缺失是随机的，可以使用所有非缺失成绩的平均值来填补缺失值。
```python
# 1. 使用平均值填补
mean_math = df['数学成绩'].mean()
df['数学成绩'].fillna(mean_math, inplace=True)
```
## 2. 使用中位数或众数填补：
对于偏态分布的数据，使用中位数或众数来填补缺失值可能更合适。
```python
# 2. 使用中位数填补
median_english = df['英语成绩'].median()
df['英语成绩'].fillna(median_english, inplace=True)
```
## 3. K最近邻（KNN）填补：
KNN是一种更复杂的填补方法，它根据数据点之间的相似性来预测缺失值。例如，在一个包含多个特征（如年龄、性别、收入等）的数据集中，可以使用KNN算法来找到与缺失数据点最相似的K个数据点，并使用这些点的特征值的平均值来填补缺失值。
## 4. 多重插补：
多重插补是一种生成多个完整数据集的方法，每个数据集对缺失值有不同的估计。然后，对这些数据集分别进行分析，最后合并结果。这种方法可以减少单一填补方法可能引入的偏差。
## 5. 使用模型预测缺失值：
在某些情况下，可以使用回归模型、决策树或其他机器学习算法来预测缺失值。例如，如果数据集中的缺失值与某些特征（如时间、地点等）有关，可以构建一个模型，将这些特征作为输入，预测缺失的目标变量。
## 6. 删除含有缺失值的记录：
在缺失值较少的情况下，或者当缺失值对整体数据集的影响不大时，可以选择直接删除含有缺失值的记录。这种方法简单直接，但可能会导致信息的损失。
## 7. 使用热卡填补：
热卡填补是一种替换方法，它从数据集中的相似记录中随机选择一个值来填补缺失值。这种方法类似于KNN，但通常不涉及复杂的算法，而是根据一些简单的规则（如年龄、性别等）来选择替换值。
## 8. 使用冷卡填补：
冷卡填补是一种替换方法，它使用外部数据源中的值来填补缺失值。这种方法适用于当内部数据不足以填补缺失值时，可以从相关的外部数据源中获取信息。
## 9. 使用时间序列分析填补：
对于时间序列数据，可以使用时间序列分析方法（如移动平均、指数平滑等）来填补缺失值。这种方法利用了时间序列数据的内在时间依赖性。
## 10. 使用特定领域的知识填补：
在某些情况下，可以根据特定领域的知识来填补缺失值。例如，在医疗数据分析中，如果某个病人的某个检查结果缺失，可以根据该病人的其他检查结果和临床知识来估计缺失值。

这些例子展示了缺失值处理的多种方法，每种方法都有其适用的场景和优缺点。选择合适的方法需要考虑数据的特性、缺失值的类型以及分析的目标。















